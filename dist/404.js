!function(){"use strict";window.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".workflow-grid .workflow-card").forEach(e=>{const t=e.dataset.storageKey,n=e.querySelector(".status");if(!n)return;let o=!1;"racewaySchedule"===t?o=["ductbankSchedule","traySchedule","conduitSchedule"].some(e=>localStorage.getItem(e)):"optimalRoute"===t?o=["cableSchedule","traySchedule"].every(e=>localStorage.getItem(e)):t&&(o=!!localStorage.getItem(t)),o?(e.classList.add("complete"),n.textContent="âœ“",n.setAttribute("aria-label","Completed")):n.textContent="Incomplete"})});const e="a[href],button:not([disabled]),textarea:not([disabled]),input:not([disabled]),select:not([disabled]),[tabindex]:not([tabindex='-1'])";function t(t,n){if("Tab"!==t.key)return;const o=n.querySelectorAll(e);if(!o.length)return;const d=o[0],r=o[o.length-1];t.shiftKey&&document.activeElement===d?(t.preventDefault(),r.focus()):t.shiftKey||document.activeElement!==r||(t.preventDefault(),d.focus())}document.addEventListener("DOMContentLoaded",function(){document.addEventListener("keydown",e=>{if("ArrowUp"!==e.key&&"ArrowDown"!==e.key)return;const t=e.target;if(!["INPUT","SELECT","TEXTAREA"].includes(t.tagName))return;const n=t.closest("td");if(!n||!n.closest("table"))return;const o=n.parentElement,d=n.cellIndex,r="ArrowUp"===e.key?o.previousElementSibling:o.nextElementSibling;if(!r)return;const a=r.cells[d];if(!a)return;const i=a.querySelector("input, select, textarea");i&&(e.preventDefault(),i.focus(),"function"==typeof i.select&&i.select())})}),window.initSettings=function(){const n=document.getElementById("settings-btn"),o=document.getElementById("settings-menu");if(n&&o){o.setAttribute("role","dialog"),o.setAttribute("aria-modal","true"),o.setAttribute("aria-hidden","true");let d=!1;const r=e=>{"Escape"===e.key?i():t(e,o)},a=()=>{d=!0,o.style.display="flex",o.setAttribute("aria-hidden","false"),n.setAttribute("aria-expanded","true"),document.addEventListener("keydown",r);const t=o.querySelectorAll(e);t.length&&t[0].focus()},i=()=>{d&&(d=!1,o.style.display="none",o.setAttribute("aria-hidden","true"),n.setAttribute("aria-expanded","false"),document.removeEventListener("keydown",r),n.focus())};n.addEventListener("click",()=>{d?i():a()}),document.addEventListener("click",e=>{d&&!o.contains(e.target)&&e.target!==n&&i()})}},window.initDarkMode=function(){const e=document.getElementById("dark-toggle"),t=JSON.parse(localStorage.getItem("ctrSession")||"{}");if(void 0===t.darkMode){const e=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;t.darkMode=e,localStorage.setItem("ctrSession",JSON.stringify(t))}document.body.classList.toggle("dark-mode",t.darkMode),e&&(e.checked=!!t.darkMode),e&&e.addEventListener("change",()=>{document.body.classList.toggle("dark-mode",e.checked),t.darkMode=e.checked,localStorage.setItem("ctrSession",JSON.stringify(t)),"function"==typeof window.saveSession&&window.saveSession(),"function"==typeof window.saveDuctbankSession&&window.saveDuctbankSession()}),window.addEventListener("storage",t=>{if("ctrSession"===t.key)try{const n=JSON.parse(t.newValue);document.body.classList.toggle("dark-mode",n&&n.darkMode),e&&(e.checked=!(!n||!n.darkMode))}catch{}})},window.initHelpModal=function(n="help-btn",o="help-modal",d){const r=document.getElementById(n),a=document.getElementById(o),i=d?document.getElementById(d):a?a.querySelector(".close-btn"):null;if(r&&a&&i){a.setAttribute("role","dialog"),a.setAttribute("aria-modal","true"),a.setAttribute("aria-hidden","true");const n=e=>{"Escape"===e.key?d():t(e,a)},o=()=>{a.style.display="flex",a.setAttribute("aria-hidden","false"),r.setAttribute("aria-expanded","true"),document.addEventListener("keydown",n);const t=a.querySelectorAll(e);t.length&&t[0].focus()},d=()=>{a.style.display="none",a.setAttribute("aria-hidden","true"),r.setAttribute("aria-expanded","false"),document.removeEventListener("keydown",n),r.focus()};r.addEventListener("click",o),i.addEventListener("click",d),a.addEventListener("click",e=>{e.target===a&&d()})}},window.initNavToggle=function(){const e=document.querySelector(".top-nav");if(!e)return;const t=e.querySelector(".nav-toggle");t&&t.addEventListener("click",()=>{e.classList.toggle("open")})},window.checkPrereqs=function(e=[]){}}();
